<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    
    <!-- Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙˆØ§Ù„ØªØ­Ø±ÙŠØ± -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.8/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <!-- Ù…ÙƒØªØ¨Ø© Google Translate -->
    <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --accent: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --text-dark: #2c3e50;
            --text-light: #ecf0f1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Cairo', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-dark);
            line-height: 1.8;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary), #1a5276);
            color: white;
            border-radius: 15px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 30px;
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            padding: 30px;
            transition: transform 0.4s ease;
        }
        
        .card:hover {
            transform: translateY(-8px);
        }
        
        .card-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--primary);
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 15px;
        }
        
        .upload-area {
            border: 3px dashed #dee2e6;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upload-area:hover {
            background-color: rgba(52, 152, 219, 0.1);
            border-color: var(--primary);
        }
        
        .upload-icon {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .file-input {
            display: none;
        }
        
        .btn {
            display: inline-block;
            padding: 14px 28px;
            background: linear-gradient(135deg, var(--primary), #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
            margin: 8px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #27ae60);
        }
        
        .language-selector {
            display: flex;
            justify-content: center;
            margin: 25px 0;
            background-color: var(--light);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .language-option {
            padding: 15px 30px;
            background-color: var(--light);
            cursor: pointer;
            flex: 1;
            text-align: center;
            transition: all 0.3s;
        }
        
        .language-option.active {
            background: linear-gradient(135deg, var(--primary), #2980b9);
            color: white;
        }
        
        .preview-area {
            margin-top: 25px;
            border: 1px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            min-height: 280px;
            max-height: 400px;
            overflow-y: auto;
            background-color: #fafafa;
        }
        
        .editor-tools {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tool-btn {
            padding: 12px 20px;
            background-color: var(--light);
            border: 1px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tool-btn:hover {
            background-color: #e9ecef;
        }
        
        .tool-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .editor {
            border: 1px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            min-height: 280px;
            outline: none;
            background-color: #fafafa;
            overflow-y: auto;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .status.success {
            background-color: rgba(46, 204, 113, 0.2);
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        
        .status.error {
            background-color: rgba(231, 76, 60, 0.2);
            color: #c0392b;
            border: 1px solid #c0392b;
        }
        
        .status.info {
            background-color: rgba(52, 152, 219, 0.2);
            color: #2980b9;
            border: æé€Ÿ 1px solid #2980b9;
        }
        
        .file-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-right: 4px solid var(--primary);
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            color: var(--dark);
            opacity: 0.8;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</h1>
            <p>ØªØ±Ø¬Ù…Ø© Ù…Ø³ØªÙ†Ø¯Ø§Øª PDF ÙˆWord Ø¨ÙŠÙ† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ</p>
        </header>
        
        <div class="main-content">
            <div class="card">
                <h2 class="card-title">ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</h2>
                
                <div class="upload-area" id="translation-upload">
                    <div class="upload-icon">ğŸ“„</div>
                    <p>Ø§Ù†Ù‚Ø± Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ù…Ù„Ù Ù„Ø±ÙØ¹ Ù…Ø³ØªÙ†Ø¯ PDF Ø£Ùˆ Word</p>
                    <p>(Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… Ù„Ù„Ù…Ù„Ù: 10MB)</p>
                    <input type="file" id="translation-file" class="file-input" accept=".pdf,.doc,.docx">
                </div>
                
                <div class="file-info" id="translation-file-info">
                    <p>Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨Ø¹Ø¯</p>
                </div>
                
                <div class="language-selector">
                    <div class="language-option active" data-direction="en-ar">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
                    <div class="language-option" data-direction="ar-en">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</div>
                </div>
                
                <div style="text-align: center;">
                    <button class="btn" id="translate-btn">
                        <span id="translate-text">ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯</span>
                        <span id="translate-loading" class="loading" style="display: none;"></span>
                    </button>
                </div>
                
                <div class="status" id="translation-status"></div>
                
                <div class="preview-area" id="translation-preview">
                    <p style="text-align: center;">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§...</p>
                </div>
                
                <div style="text-align: center;">
                    <button class="btn btn-secondary" id="download-translation" disabled>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…ØªØ±Ø¬Ù…</button>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">Ù…Ø­Ø±Ø± PDF</h2>
                
                <div class="upload-area" id="editor-upload">
                    <æé€Ÿ class="upload-icon">âœï¸</div>
                    <p>Ø§Ù†Ù‚Ø± Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ù…Ù„Ù Ù„Ø±ÙØ¹ Ù…Ù„Ù PDF Ù„Ù„ØªØ¹Ø¯ÙŠÙ„</p>
                    <p>(Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… Ù„Ù„Ù…Ù„Ù: 10MB)</p>
                    <input type="file" id="editor-file" class="file-input" accept=".pdf">
                </div>
                
                <div class="file-info" id="editor-file-info">
                    <p>Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨Ø¹Ø¯</p>
                </div>
                
                <div class="editor-tools">
                    <button class="tool-btn" data-tool="text">Ø¥Ø¶Ø§ÙØ© Ù†Øµ</button>
                    <button class="tool-btn" data-tool="highlight">ØªÙ…ÙŠÙŠØ²</button>
                    <button class="tool-btn"æé€Ÿ data-tool="comment">Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚</button>
                    <button class="tool-btn" data-tool="signature">Ø¥Ø¶Ø§ÙØ© ØªÙˆÙ‚ÙŠØ¹</button>
                </div>
                
                <div class="editor" id="pdf-editor" contenteditable="true">
                    <p style="text-align: center;">Ù…Ø­ØªÙˆÙŠØ§Øª PDF Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ù„Ù„ØªØ­Ø±ÙŠØ±...</p>
                </div>
                
                <div class="status" id="editor-status"></div>
                
                <div style="text-align: center;">
                    <button class="btn btn-secondary" id="save-pdf" disabled>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                    <button class="btn" id="download-edited" disabled>ØªØ­Ù…ÙŠÙ„ PDF Ø§Ù„Ù…Ø¹Ø¯Ù„</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ &copy; 2023</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const translationUpload = document.getElementById('translation-upload');
        const translationFile = document.getElementById('translation-file');
        const translateBtn = document.getElementById('translate-btn');
        const translationStatus = document.getElementById('translation-status');
        const translationPreview = document.getElementById('translation-preview');
        const downloadTranslation = document.getElementById('download-translation');
        const translationFileInfo = document.getElementById('translation-file-info');
        
        const editorUpload = document.getElementById('editor-upload');
        const editorFile = document.getElementById('editor-file');
        const pdfEditor = document.getElementById('pdf-editor');
        const editorStatus = document.getElementById('editor-status');
        const savePdf = document.getElementById('save-pdf');
        const downloadEdited = document.getElementById('download-edited');
        const editorFileInfo = document.getElementById('editor-file-info');
        
        const languageOptions = document.querySelectorAll('.language-option');
        const toolButtons = document.querySelectorAll('.tool-btn');
        
        const translateText = document.getElementById('translate-text');
        const translateLoading = document.getElementById('translate-loading');
        
        // Variables
        let currentTranslationDirection = 'en-ar';
        let currentTool = null;
        let translatedDocument = null;
        let editedPdf = null;
        let currentPdfBytes = null;
        
        // Event Listeners
        translationUpload.addEventListener('click', () => {
            translationFile.click();
        });
        
        translationFile.addEventListener('change', handleTranslationFileUpload);
        
        editorUpload.addEventListener('click', () => {
            editorFile.click();
        });
        
        editorFile.addEventListener('change', handleEditorFileUpload);
        
        translateBtn.addEventListener('click', translateDocument);
        
        downloadTranslation.addEventListener('click', downloadTranslatedFile);
        
        savePdf.addEventListener('click', savePdfChanges);
        
        downloadEdited.addEventListener('click', downloadEditedFile);
        
        languageOptions.forEach(option => {
            option.addEventListener('click', () => {
                languageOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                currentTranslationDirection = option.dataset.direction;
            });
        });
        
        toolButtons.forEach(button => {
            button.addEventListener('click', () => {
                toolButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                currentTool = button.dataset.tool;
                applyEditorTool(currentTool);
            });
        });
        
        // Ø¬Ø¹Ù„ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø±ÙØ¹ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨
        makeDropZone(translationUpload, translationFile);
        makeDropZone(editorUpload, editorFile);
        
        // Functions
        function makeDropZone(dropZone, fileInput) {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropZone.style.borderColor = var(--primary);
                dropZone.style.backgroundColor = 'rgba(52, 152, 219, 0.1)';
            }
            
            function unhighlight() {
                dropZone.style.borderColor = '#dee2e6';
                dropZone.style.backgroundColor = 'transparent';
            }
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                fileInput.files = files;
                
                if (fileInput.id === 'translation-file') {
                    handleTranslationFileUpload({target: fileInput});
                } else {
                    handleEditorFileUpload({target: fileInput});
                }
            }
        }
        
        function handleTranslationFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const validTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/msword'];
            if (!validTypes.includes(file.type)) {
                showStatus(translationStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£Ùˆ Word', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showStatus(translationStatus, 'Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ (10MB)', 'error');
                return;
            }
            
            translationFileInfo.innerHTML = `
                <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}</p>
                <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${file.type}</p>
                <p><strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${(file.size / 1024 / 1024).toFixed(2)} MB</p>
            `;
            
            showStatus(translationStatus, `ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
            downloadTranslation.disabled = false;
            
            readFileForPreview(file, translationPreview, 'translation');
        }
        
        function handleEditorFileUpload(event) {
            const file = event.target.files[0];
            if (!æé€Ÿ file) return;
            
            if (file.type !== 'application/pdf') {
                showStatus(editorStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù PDF', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showStatus(editorStatus, 'Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ (10MB)', 'error');
                return;
            }
            
            editorFileInfo.innerHTML = `
                <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}</p>
                <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${file.type}</p>
                <p><æé€Ÿ strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${(file.size / 1024 / 1024).æé€ŸtoFixed(2)} MB</p>
            `;
            
            showStatus(editorStatus, `ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
            savePdf.disabled = false;
            downloadEdited.disabled = false;
            
            readFileForPreview(file, pdfEditor, 'editor');
        }
        
        function readFileForPreview(file, element, type) {
            showStatus(type === 'translation' ? translationStatus : editorStatus, 'Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù...', 'info');
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const content = e.target.result;
                
                if (type === 'translation') {
                    if (file.type === 'application/pdf') {
                        renderPdfPreview(content, element);
                    } else {
                        renderWordPreview(content, element);
                    }
                } else {
                    renderPdfForEditing(content, element);
                    currentPdfBytes = content;
                }
            };
            
            if (file.type === 'application/pdf') {
                reader.readAsArrayBuffer(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }
        
        function renderPdfPreview(data, element) {
            element.innerHTML = `
                <div style="text-align: center;">
                    <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© PDF</h3>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF...</p>
                </div>
            `;
            
            // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ù…ÙŠÙ„ PDF Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… iframe (ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù†Ø³ØªØ®Ø¯Ù… PDF.js)
            setTimeout(() => {
                const blob = new Blob([data], {type: 'application/pdf'});
                const url = URL.createObjectURL(blob);
                
                element.innerHTML = `
                    <div style="text-align: center;">
                        <h4>${translationFile.files[0].name}</h4>
                        <iframe src="${url}" width="100%" height="400px" style="border: 1px solid #ddd;"></iframe>
                    </div>
                `;
                
                showStatus(translationStatus, 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }, 1500);
        }
        
        function renderWordPreview(data, element) {
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© mammoth Ù„ØªØ­ÙˆÙŠÙ„ Word Ø¥Ù„Ù‰ HTML
            mammoth.convertToHtml({arrayBuffer: data})
                .then(function(result) {
                    element.innerHTML = result.value;
                    showStatus(translationStatus, 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø³ØªÙ†Ø¯ Word Ø¨Ù†Ø¬Ø§Ø­', 'success');
                })
                .catch(function(err) {
                    console.error(err);
                    element.innerHTML = `
                        <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø³ØªÙ†Ø¯ Word.</p>
                        <p>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£: ${err.message}</p>
                    `;
                    showStatus(translationStatus, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø³ØªÙ†Ø¯ Word', 'error');
                });
        }
        
        function renderPdfForEditing(data, element) {
            element.innerHTML = `
                <div style="text-align: center;">
                    <h3>Ù…Ø­Ø±Ø± PDF</h3>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±...</p>
                </div>
            `;
            
            showStatus(editorStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±...', 'info');
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† PDF
            setTimeout(() => {
                const blob = new Blob([data], {type: 'application/pdf'});
                const url = URL.createObjectURL(blob);
                
                element.innerHTML = `
                    <h4>Ù…Ø­ØªÙˆÙ‰ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±</h4>
                    <iframe src="${url}" width="100%" height="300px" style="border: 1px solid #ddd;"></iframe>
                    <p>Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­Ø±ÙŠØ± Ø£Ø¹Ù„Ø§Ù‡ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù.</p>
                `;
                showStatus(editorStatus, 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØ­Ø±ÙŠØ±', 'success');
            }, 2000);
        }
        
        function translateDocument() {
            if (!translationFile.files[0]) {
                showStatus(translationStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ø³ØªÙ†Ø¯ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            translateText.style.display = 'none';
            translateLoading.style.display = 'inline-block';
            translateBtn.disabled = true;
            
            showStatus(translationStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯...', 'info');
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Google Translate API Ù„Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©
            setTimeout(() => {
                const fromLang = currentTranslationDirection === 'en-ar' ? 'en' : 'ar';
                const toLang = currentTranslationDirection === 'en-ar' ? 'ar' : 'en';
                
                extractTextFromFile(translationFile.files[0])
                    .then(text => {
                        return translateTextWithGoogle(text, fromLang, toLang);
                    })
                    .then(translatedText => {
                        translationPreview.innerHTML = `
                            <h3>Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…ØªØ±Ø¬Ù…</h3>
                            <div style="padding: 15px; background: white; border-radius: 8px;">
                                ${translatedText}
                            </div>
                        `;
                        
                        translatedDocument = translatedText;
                        showStatus(translationStatus, 'ØªÙ…Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    })
                    .catch(error => {
                        console.error(error);
                        showStatus(translationStatus, `ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø©: ${error.message}`, 'error');
                    })
                    .finally(() => {
                        translateText.style.display = 'inline';
                        translateLoading.style.display = 'none';
                        translateBtn.disabled = false;
                    });
            }, 1000);
        }
        
        function extractTextFromFile(file) {
            return new Promise((resolve, reject) => {
                if (file.type === 'application/pdf') {
                    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† PDF
                    resolve("Ù‡Ø°Ø§ Ù…Ø­ØªÙˆÙ‰ Ù†ØµÙŠ Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† PDF. ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ.");
                } else {
                    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Word
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        mammoth.extractRawText({arrayBuffer: e.target.result})
                            .then(result => resolve(result.value))
                            .catch(reject);
                    };
                    reader.onerror = reject;
                    reader.readAsArrayBuffer(file);
                }
            });
        }
        
        function translateTextWithGoogle(text, sourceLang, targetLang) {
            return new Promise((resolve, reject) => {
                // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù†Ø³ØªØ®Ø¯Ù… Google Translate API
                // Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„ØªØ±Ø¬Ù…Ø©
                try {
                    setTimeout(() => {
                        if (sourceLang === 'en' && targetLang === 'ar') {
                            resolve(`
                                <h4>Ù†Øµ Ù…ØªØ±Ø¬Ù… Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h4>
                                <p>Ù‡Ø°Ø§ Ù†Øµ ØªÙ…Øª ØªØ±Ø¬Ù…ØªÙ‡ Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø©.</p>
                                <p>Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ: ${text.substring(0, 100)}...</p>
                            `);
                        } else {
                            resolve(`
                                <h4>Text translated from Arabic to English</h4>
                                <p>This is text translated from Arabic to English using translation service.</p>
                                <p>Original text: ${text.substring(0, 100)}...</p>
                            `);
                        }
                    }, 2000);
                } catch (error) {
                    reject(error);
                }
            });
        }
        
        function applyEditorTool(tool) {
            switch(tool) {
                case 'text':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ. Ø§Ù†Ù‚Ø± ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ ÙÙŠÙ‡.', 'info');
                    break;
                case 'highlight':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ². Ø­Ø¯Ø¯ Ø§Ù„Ù†Øµ Ù„ØªÙ…ÙŠÙŠØ²Ù‡.', 'info');
                    break;
                case 'comment':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚. Ø§Ù†Ù‚Ø± ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚ ÙÙŠÙ‡.', 'info');
                    break;
                case 'signature':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹. Ø§Ù†Ù‚Ø± ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØ© ØªÙˆÙ‚ÙŠØ¹ ÙÙŠÙ‡.', 'info');
                    break;
            }
        }
        
        function savePdfChanges() {
            if (!editorFile.files[0]) {
                showStatus(editorStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            showStatus(editorStatus, 'Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª...', 'info');
            
            setTimeout(() => {
                showStatus(editorStatus, 'ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                editedPdf = true;
            }, 1500);
        }
        
        function downloadEditedFile() {
            if (!editedPdf) {
                showStatus(editorStatus, 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ PDF Ù…Ø¹Ø¯Ù„ Ù„Ù„ØªØ­Ù…ÙŠÙ„', 'error');
                return;
            }
            
            showStatus(editorStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± PDF Ù„Ù„ØªØ­Ù…ÙŠÙ„...', 'info');
            
            setTimeout(() => {
                const originalName = editorFile.files[0].name;
                const extension = originalName.split('.').pop();
                const baseName = originalName.replace('.' + extension, '');
                const newFileName = `${baseName}_edited.${extension}`;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ÙˆÙ‡Ù…ÙŠ Ù„Ù„ØªØ­Ù…ÙŠÙ„
                const content = "Ù‡Ø°Ø§ Ù…Ù„Ù PDF Ù…Ø¹Ø¯Ù„. ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„ØŒ Ø³ÙŠÙƒÙˆÙ† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø¹Ø¯Ù„ ÙØ¹Ù„ÙŠØ§Ù‹.";
                const blob = new Blob([content], {type: 'application/octet-stream'});
                saveAs(blob, newFileName);
                
                showStatus(editorStatus, 'ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ PDF Ø§Ù„Ù…Ø¹Ø¯Ù„', 'success');
            }, 1000);
        }
        
        function downloadTranslatedFile() {
            if (!translatedDocument) {
                showStatus(translationStatus, 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯ Ù…ØªØ±Ø¬Ù… Ù„Ù„ØªØ­Ù…ÙŠÙ„', 'error');
                return;
            }
            
            showStatus(translationStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù…Ù„Ù Ù„Ù„ØªØ­Ù…ÙŠÙ„...', 'info');
            
            setTimeout(() => {
                const fromLang = currentTranslationDirection === 'en-ar' ? 'en' : 'ar';
                const toLang = currentTranslationDirection === 'en-ar' ? 'ar' : 'en';
                const originalName = translationFile.files[0].name;
                const extension = originalName.split('.').pop();
                const baseName = originalName.replace('.' + extension, '');
                const newFileName = `${baseName}_${fromLang}_to_${toLang}.${extension}`;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ±Ø¬Ù…
                const blob = new Blob([translatedDocument], {type: 'text/plain;charset=utf-8'});
                saveæé€Ÿ As(blob, newFileName);
                
                showStatus(translationStatus, 'ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªØ±Ø¬Ù…', 'success');
            }, 1000);
        }
        
        function showStatus(element, message, type) {
            element.textContent = message;
            element.className = 'status';
            if (type) {
                element.classList.add(type);
            }
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ù…ØªØ±Ø¬Ù… Google
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en',
                includedLanguages: 'en,ar',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            }, 'google_translate_element');
        }
    </script>
    
    <!-- Ø¹Ù†ØµØ± ØªØ±Ø¬Ù…Ø© Google -->
    <div id="google_translate_element" style="display: none;"></div>
</body>
</html>
