<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <!-- Ù…ÙƒØªØ¨Ø§Øª Ù…Ø¹Ø§Ù„Ø¬Ø© PDF -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    <!-- Ù…ÙƒØªØ¨Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø³ØªÙ†Ø¯Ø§Øª Word -->
    <script src="https://unpkg.com/mammoth@1.4.8/mammoth.browser.min.js"></script>
    <!-- Ù…ÙƒØªØ¨Ø© FileSaver Ù„Ù„ØªØ­Ù…ÙŠÙ„ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- Ù…ÙƒØªØ¨Ø© Turndown Ù„ØªØ­ÙˆÙŠÙ„ HTML Ø¥Ù„Ù‰ Markdown -->
    <script src="https://unpkg.com/turndown@7.1.1/dist/turndown.js"></script>
    <!-- Ù…ÙƒØªØ¨Ø© Showdown Ù„ØªØ­ÙˆÙŠÙ„ Markdown Ø¥Ù„Ù‰ HTML -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.1/showdown.min.js"></script>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --accent: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --border: #dee2e6;
            --text-dark: #2c3e50;
            --text-light: #ecf0f1;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Cairo', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-dark);
            line-height: 1.8;
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--gradient);
            color: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 30px;
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 30px;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .card-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
            font-weight: 600;
        }
        
        .upload-area {
            border: 3px dashed var(--border);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s;
            background-color: rgba(52, 152, 219, 0.05);
        }
        
        .upload-area:hover {
            background-color: rgba(52, 152, 219, 0.1);
            border-color: var(--primary);
        }
        
        .upload-area.drag-over {
            background-color: rgba(46, 204, 113, 0.2);
            border-color: var(--secondary);
        }
        
        .upload-icon {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .file-input {
            display: none;
        }
        
        .btn {
            display: inline-block;
            padding: 14px 28px;
            background: linear-gradient(135deg, var(--primary), #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s;
            margin: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #27ae60);
        }
        
        .btn-accent {
            background: linear-gradient(135deg, var(--accent), #c0392b);
        }
        
        .btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .language-selector {
            display: flex;
            justify-content: center;
            margin: 25px 0;
            background-color: var(--light);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .language-option {
            padding: 15px 30px;
            background-color: var(--light);
            cursor: pointer;
            flex: 1;
            text-align: center;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .language-option.active {
            background: linear-gradient(135deg, var(--primary), #2980b9);
            color: white;
        }
        
        .preview-area {
            margin-top: 25px;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            min-height: 280px;
            max-height: 400px;
            overflow-y: auto;
            background-color: #fafafa;
            line-height: 1.6;
        }
        
        .editor-tools {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tool-btn {
            padding: 12px 20px;
            background-color: var(--light);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .tool-btn:hover {
            background-color: #e9ecef;
        }
        
        .tool-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .editor {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            min-height: 280px;
            outline: none;
            background-color: #fafafa;
            line-height: 1.6;
            overflow-y: auto;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }
        
        .status.success {
            background-color: rgba(46, 204, 113, 0.2);
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        
        .status.error {
            background-color: rgba(231, 76, 60, 0.2);
            color: #c0392b;
            border: 1px solid #c0392b;
        }
        
        .status.info {
            background-color: rgba(52, 152, 219, 0.2);
            color: #2980b9;
            border: 1px solid #2980b9;
        }
        
        .file-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-right: 4px solid var(--primary);
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            color: var(--dark);
            opacity: 0.8;
            font-size: 1.1rem;
        }
        
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .text-right {
            text-align: right;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mb-3 {
            margin-bottom: 1rem;
        }
        
        .mt-3 {
            margin-top: 1rem;
        }
        
        .api-key-container {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid var(--border);
        }
        
        .api-key-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 5px;
            margin: 10px 0;
            font-size: 1rem;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted #ccc;
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            right: 50%;
            margin-right: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</h1>
            <p class="subtitle">ØªØ±Ø¬Ù…Ø© Ù…Ø³ØªÙ†Ø¯Ø§Øª PDF ÙˆWord Ø¨ÙŠÙ† Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ</p>
        </header>
        
        <div class="main-content">
            <div class="card">
                <h2 class="card-title">ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</h2>
                
                <div class="upload-area" id="translation-upload">
                    <div class="upload-icon">ğŸ“„</div>
                    <p>Ø§Ù†Ù‚Ø± Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ù…Ù„Ù Ù„Ø±ÙØ¹ Ù…Ø³ØªÙ†Ø¯ PDF Ø£Ùˆ Word</p>
                    <p class="small">(Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… Ù„Ù„Ù…Ù„Ù: 10MB)</p>
                    <input type="file" id="translation-file" class="file-input" accept=".pdf,.doc,.docx">
                </div>
                
                <div class="file-info" id="translation-file-info">
                    <p>Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨Ø¹Ø¯</p>
                </div>
                
                <div class="language-selector">
                    <div class="language-option active" data-direction="en-ar">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
                    <div class="language-option" data-direction="ar-en">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</div>
                </div>
                
                <div class="api-key-container">
                    <label for="api-key">Ù…ÙØªØ§Ø­ API Ù„Ù„ØªØ±Ø¬Ù…Ø©: <span class="tooltip">(ØŸ)
                        <span class="tooltiptext">
                            Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ API: <br>
                            1. Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨ Google Cloud <br>
                            2. ØªÙØ¹ÙŠÙ„ Cloud Translation API <br>
                            3. Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ API
                        </span>
                    </span></label>
                    <input type="password" id="api-key" class="api-key-input" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ API Ù„Ù„ØªØ±Ø¬Ù…Ø©">
                    <button class="btn btn-accent" id="save-api-key">Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­</button>
                </div>
                
                <div class="text-center">
                    <button class="btn" id="translate-btn">
                        <span id="translate-text">ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯</span>
                        <span id="translate-loading" class="loading" style="display: none;"></span>
                    </button>
                </div>
                
                <div class="status" id="translation-status"></div>
                
                <div class="preview-area" id="translation-preview">
                    <p class="text-center">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§...</p>
                </div>
                
                <div class="text-center">
                    <button class="btn btn-secondary" id="download-translation" disabled>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…ØªØ±Ø¬Ù…</button>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">Ù…Ø­Ø±Ø± PDF</h2>
                
                <div class="upload-area" id="editor-upload">
                    <div class="upload-icon">âœï¸</div>
                    <p>Ø§Ù†Ù‚Ø± Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ù…Ù„Ù Ù„Ø±ÙØ¹ Ù…Ù„Ù PDF Ù„Ù„ØªØ¹Ø¯ÙŠÙ„</p>
                    <p class="small">(Ø£Ù‚ØµÙ‰ Ø­Ø¬Ù… Ù„Ù„Ù…Ù„Ù: 10MB)</p>
                    <input type="file" id="editor-file" class="file-input" accept=".pdf">
                </div>
                
                <div class="file-info" id="editor-file-info">
                    <p>Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨Ø¹Ø¯</p>
                </div>
                
                <div class="editor-tools">
                    <button class="tool-btn" data-tool="text">Ø¥Ø¶Ø§ÙØ© Ù†Øµ</button>
                    <button class="tool-btn" data-tool="highlight">ØªÙ…ÙŠÙŠØ²</button>
                    <button class="tool-btn" data-tool="comment">Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚</button>
                    <button class="tool-btn" data-tool="font-size">Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</button>
                </div>
                
                <div class="editor" id="pdf-editor" contenteditable="true">
                    <p class="text-center">Ù…Ø­ØªÙˆÙŠØ§Øª PDF Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ù„Ù„ØªØ­Ø±ÙŠØ±...</p>
                </div>
                
                <div class="status" id="editor-status"></div>
                
                <div class="text-center">
                    <button class="btn btn-secondary" id="save-pdf" disabled>Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                    <button class="btn" id="download-edited" disabled>ØªØ­Ù…ÙŠÙ„ PDF Ø§Ù„Ù…Ø¹Ø¯Ù„</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© ÙˆØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ &copy; 2023 | Ø§Ù„Ø¯Ø¹Ù…: support@doctranslate.com</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const translationUpload = document.getElementById('translation-upload');
        const translationFile = document.getElementById('translation-file');
        const translateBtn = document.getElementById('translate-btn');
        const translationStatus = document.getElementById('translation-status');
        const translationPreview = document.getElementById('translation-preview');
        const downloadTranslation = document.getElementById('download-translation');
        const translationFileInfo = document.getElementById('translation-file-info');
        
        const editorUpload = document.getElementById('editor-upload');
        const editorFile = document.getElementById('editor-file');
        const pdfEditor = document.getElementById('pdf-editor');
        const editorStatus = document.getElementById('editor-status');
        const savePdf = document.getElementById('save-pdf');
        const downloadEdited = document.getElementById('download-edited');
        const editorFileInfo = document.getElementById('editor-file-info');
        
        const languageOptions = document.querySelectorAll('.language-option');
        const toolButtons = document.querySelectorAll('.tool-btn');
        
        const translateText = document.getElementById('translate-text');
        const translateLoading = document.getElementById('translate-loading');
        
        const apiKeyInput = document.getElementById('api-key');
        const saveApiKeyBtn = document.getElementById('save-api-key');
        
        // Variables
        let currentTranslationDirection = 'en-ar';
        let currentTool = null;
        let translatedDocument = null;
        let editedPdf = null;
        let currentPdfBytes = null;
        let apiKey = '';
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function initApp() {
            // ØªØ­Ù…ÙŠÙ„ Ù…ÙØªØ§Ø­ API Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            const savedApiKey = localStorage.getItem('translation-api-key');
            if (savedApiKey) {
                apiKey = savedApiKey;
                apiKeyInput.value = 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';
            }
            
            // ØªØ¹Ø±ÙŠÙ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
            makeDropZone(translationUpload, translationFile);
            makeDropZone(editorUpload, editorFile);
        }
        
        // Event Listeners
        translationUpload.addEventListener('click', () => {
            translationFile.click();
        });
        
        translationFile.addEventListener('change', handleTranslationFileUpload);
        
        editorUpload.addEventListener('click', () => {
            editorFile.click();
        });
        
        editorFile.addEventListener('change', handleEditorFileUpload);
        
        translateBtn.addEventListener('click', translateDocument);
        
        downloadTranslation.addEventListener('click', downloadTranslatedFile);
        
        savePdf.addEventListener('click', savePdfChanges);
        
        downloadEdited.addEventListener('click', downloadEditedFile);
        
        languageOptions.forEach(option => {
            option.addEventListener('click', () => {
                languageOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                currentTranslationDirection = option.dataset.direction;
            });
        });
        
        toolButtons.forEach(button => {
            button.addEventListener('click', () => {
                toolButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                currentTool = button.dataset.tool;
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
                applyEditorTool(currentTool);
            });
        });
        
        saveApiKeyBtn.addEventListener('click', () => {
            if (apiKeyInput.value.trim()) {
                if (apiKeyInput.value !== 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢') {
                    apiKey = apiKeyInput.value.trim();
                    localStorage.setItem('translation-api-key', apiKey);
                    apiKeyInput.value = 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';
                    showStatus(translationStatus, 'ØªÙ… Ø­ÙØ¸ Ù…ÙØªØ§Ø­ API Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } else {
                    showStatus(translationStatus, 'Ø§Ù„Ù…ÙØªØ§Ø­ Ù…Ø­ÙÙˆØ¸ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'info');
                }
            } else {
                showStatus(translationStatus, 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­ API', 'error');
            }
        });
        
        // Ø¬Ø¹Ù„ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø±ÙØ¹ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨
        function makeDropZone(dropZone, fileInput) {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropZone.classList.add('drag-over');
            }
            
            function unhighlight() {
                dropZone.classList.remove('drag-over');
            }
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                fileInput.files = files;
                
                if (fileInput.id === 'translation-file') {
                    handleTranslationFileUpload({target: fileInput});
                } else {
                    handleEditorFileUpload({target: fileInput});
                }
            }
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„ØªØ±Ø¬Ù…Ø©
        function handleTranslationFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const validTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/msword'];
            if (!validTypes.includes(file.type)) {
                showStatus(translationStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£Ùˆ Word', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showStatus(translationStatus, 'Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ (10MB)', 'error');
                return;
            }
            
            translationFileInfo.innerHTML = `
                <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}</p>
                <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${file.type}</p>
                <p><strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${(file.size / 1024 / 1024).toFixed(2)} MB</p>
            `;
            
            showStatus(translationStatus, `ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
            downloadTranslation.disabled = false;
            
            // Ù‚Ø±Ø§Ø¡Ø© ÙˆÙ…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù
            readFileForPreview(file, translationPreview, 'translation');
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ù…Ø­Ø±Ø±
        function handleEditorFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.type !== 'application/pdf') {
                showStatus(editorStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù PDF', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showStatus(editorStatus, 'Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ (10MB)', 'error');
                return;
            }
            
            editorFileInfo.innerHTML = `
                <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}</p>
                <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${file.type}</p>
                <p><strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${(file.size / 1024 / 1024).toFixed(2)} MB</p>
            `;
            
            showStatus(editorStatus, `ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
            savePdf.disabled = false;
            downloadEdited.disabled = false;
            
            // Ù‚Ø±Ø§Ø¡Ø© ÙˆÙ…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù
            readFileForPreview(file, pdfEditor, 'editor');
        }
        
        // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        function readFileForPreview(file, element, type) {
            showStatus(type === 'translation' ? translationStatus : editorStatus, 'Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù...', 'info');
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const content = e.target.result;
                
                if (type === 'translation') {
                    if (file.type === 'application/pdf') {
                        renderPdfPreview(content, element);
                    } else {
                        renderWordPreview(content, element);
                    }
                } else {
                    renderPdfForEditing(content, element);
                    currentPdfBytes = content;
                }
            };
            
            if (file.type === 'application/pdf') {
                reader.readAsArrayBuffer(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }
        
        // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF
        function renderPdfPreview(data, element) {
            element.innerHTML = `
                <div class="text-center">
                    <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© PDF</h3>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF...</p>
                </div>
            `;
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… PDF.js Ù„Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF
            const loadingTask = pdfjsLib.getDocument({data: data});
            loadingTask.promise.then(function(pdf) {
                return pdf.getPage(1).then(function(page) {
                    const scale = 1.5;
                    const viewport = page.getViewport({scale: scale});
                    
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    element.innerHTML = `
                        <div class="text-center">
                            <h4>${translationFile.files[0].name}</h4>
                            <p>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø§Ù„Ù…Ø³ØªÙ†Ø¯:</p>
                        </div>
                    `;
                    element.appendChild(canvas);
                    
                    const renderContext = {
                        canvasContext: context,
                        viewport: viewport
                    };
                    
                    page.render(renderContext).promise.then(function() {
                        showStatus(translationStatus, 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    });
                });
            }).catch(function(err) {
                console.error(err);
                element.innerHTML = `
                    <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF.</p>
                    <p>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£: ${err.message}</p>
                `;
                showStatus(translationStatus, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© PDF', 'error');
            });
        }
        
        // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø³ØªÙ†Ø¯ Word
        function renderWordPreview(data, element) {
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© mammoth Ù„ØªØ­ÙˆÙŠÙ„ Word Ø¥Ù„Ù‰ HTML
            mammoth.convertToHtml({arrayBuffer: data})
                .then(function(result) {
                    element.innerHTML = result.value;
                    showStatus(translationStatus, 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø³ØªÙ†Ø¯ Word Ø¨Ù†Ø¬Ø§Ø­', 'success');
                })
                .catch(function(err) {
                    console.error(err);
                    element.innerHTML = `
                        <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø³ØªÙ†Ø¯ Word.</p>
                        <p>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£: ${err.message}</p>
                    `;
                    showStatus(translationStatus, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø³ØªÙ†Ø¯ Word', 'error');
                });
        }
        
        // Ø¹Ø±Ø¶ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±
        function renderPdfForEditing(data, element) {
            element.innerHTML = `
                <div class="text-center">
                    <h3>Ù…Ø­Ø±Ø± PDF</h3>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±...</p>
                </div>
            `;
            
            showStatus(editorStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±...', 'info');
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† PDF Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… pdf.js
            const loadingTask = pdfjsLib.getDocument({data: data});
            loadingTask.promise.then(function(pdf) {
                let totalPages = pdf.numPages;
                let extractedText = '';
                
                function extractPageText(pageNum) {
                    return pdf.getPage(pageNum).then(function(page) {
                        return page.getTextContent().then(function(textContent) {
                            let pageText = '';
                            textContent.items.forEach(function(item) {
                                pageText += item.str + ' ';
                            });
                            return pageText;
                        });
                    });
                }
                
                let pagePromises = [];
                for (let i = 1; i <= totalPages; i++) {
                    pagePromises.push(extractPageText(i));
                }
                
                Promise.all(pagePromises).then(function(pagesText) {
                    extractedText = pagesText.join('\n\n');
                    
                    element.innerHTML = `
                        <h4>Ù…Ø­ØªÙˆÙ‰ PDF Ù„Ù„ØªØ­Ø±ÙŠØ±</h4>
                        <p>Ù‡Ø°Ø§ Ù…Ø­ØªÙˆÙ‰ Ù†ØµÙŠ Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ù…Ù„Ù PDF. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­Ø±Ø±.</p>
                        <p>Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§ØªØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª" Ø«Ù… "ØªØ­Ù…ÙŠÙ„ PDF Ø§Ù„Ù…Ø¹Ø¯Ù„".</p>
                        <div class="content-box">${extractedText}</div>
                    `;
                    showStatus(editorStatus, 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØ­Ø±ÙŠØ±', 'success');
                });
            }).catch(function(err) {
                console.error(err);
                element.innerHTML = `
                    <p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ PDF.</p>
                    <p>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£: ${err.message}</p>
                `;
                showStatus(editorStatus, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ PDF', 'error');
            });
        }
        
        // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯
        function translateDocument() {
            if (!translationFile.files[0]) {
                showStatus(translationStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ø³ØªÙ†Ø¯ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            if (!apiKey) {
                showStatus(translationStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­ API Ù„Ù„ØªØ±Ø¬Ù…Ø©', 'error');
                return;
            }
            
            translateText.style.display = 'none';
            translateLoading.style.display = 'inline-block';
            translateBtn.disabled = true;
            
            showStatus(translationStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯...', 'info');
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ù…Ù„Ù
            extractTextFromFile(translationFile.files[0])
                .then(text => {
                    // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Google Translate API
                    return translateTextWithApi(text, currentTranslationDirection);
                })
                .then(translatedText => {
                    // Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ±Ø¬Ù…
                    translationPreview.innerHTML = `
                        <h3>Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…ØªØ±Ø¬Ù…</h3>
                        <div class="content-box">${translatedText}</div>
                    `;
                    
                    translatedDocument = translatedText;
                    showStatus(translationStatus, 'ØªÙ…Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                })
                .catch(error => {
                    console.error(error);
                    showStatus(translationStatus, `ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ±Ø¬Ù…Ø©: ${error.message}`, 'error');
                })
                .finally(() => {
                    translateText.style.display = 'inline';
                    translateLoading.style.display = 'none';
                    translateBtn.disabled = false;
                });
        }
        
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ù…Ù„Ù
        function extractTextFromFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const content = e.target.result;
                    
                    if (file.type === 'application/pdf') {
                        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† PDF
                        const loadingTask = pdfjsLib.getDocument({data: content});
                        loadingTask.promise.then(function(pdf) {
                            let totalPages = pdf.numPages;
                            let extractedText = '';
                            
                            function extractPageText(pageNum) {
                                return pdf.getPage(pageNum).then(function(page) {
                                    return page.getTextContent().then(function(textContent) {
                                        let pageText = '';
                                        textContent.items.forEach(function(item) {
                                            pageText += item.str + ' ';
                                        });
                                        return pageText;
                                    });
                                });
                            }
                            
                            let pagePromises = [];
                            for (let i = 1; i <= totalPages; i++) {
                                pagePromises.push(extractPageText(i));
                            }
                            
                            Promise.all(pagePromises).then(function(pagesText) {
                                resolve(pagesText.join('\n\n'));
                            }).catch(reject);
                        }).catch(reject);
                    } else {
                        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† Ù…Ø³ØªÙ†Ø¯ Word
                        mammoth.extractRawText({arrayBuffer: content})
                            .then(function(result) {
                                resolve(result.value);
                            })
                            .catch(reject);
                    }
                };
                
                reader.onerror = reject;
                
                if (file.type === 'application/pdf') {
                    reader.readAsArrayBuffer(file);
                } else {
                    reader.readAsArrayBuffer(file);
                }
            });
        }
        
        // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… API
        function translateTextWithApi(text, direction) {
            const [source, target] = direction.split('-');
            
            return fetch(`https://translation.googleapis.com/language/translate/v2?key=${apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    q: text,
                    source: source,
                    target: target,
                    format: 'text'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    throw new Error(data.error.message);
                }
                return data.data.translations[0].translatedText;
            });
        }
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±
        function applyEditorTool(tool) {
            switch(tool) {
                case 'text':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ. Ø§Ù†Ù‚Ø± ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ ÙÙŠÙ‡.', 'info');
                    break;
                case 'highlight':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ². Ø­Ø¯Ø¯ Ø§Ù„Ù†Øµ Ù„ØªÙ…ÙŠÙŠØ²Ù‡.', 'info');
                    document.execCommand('styleWithCSS', false, true);
                    document.execCommand('hiliteColor', false, '#ffeb3b');
                    break;
                case 'comment':
                    showStatus(editorStatus, 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚. Ø§Ù†Ù‚Ø± ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚ ÙÙŠÙ‡.', 'info');
                    break;
                case 'font-size':
                    const size = prompt('Ø£Ø¯Ø®Ù„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· (Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„):', '16');
                    if (size) {
                        document.execCommand('fontSize', false, size);
                    }
                    break;
            }
        }
        
        // Ø­ÙØ¸ ØªØºÙŠÙŠØ±Ø§Øª PDF
        function savePdfChanges() {
            if (!editorFile.files[0]) {
                showStatus(editorStatus, 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            showStatus(editorStatus, 'Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª...', 'info');
            
            // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù†Ø¯Ù…Ø¬ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ PDF
            setTimeout(() => {
                showStatus(editorStatus, 'ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                editedPdf = true;
            }, 1500);
        }
        
        // ØªØ­Ù…ÙŠÙ„ PDF Ø§Ù„Ù…Ø¹Ø¯Ù„
        function downloadEditedFile() {
            if (!editedPdf) {
                showStatus(editorStatus, 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ PDF Ù…Ø¹Ø¯Ù„ Ù„Ù„ØªØ­Ù…ÙŠÙ„', 'error');
                return;
            }
            
            showStatus(editorStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± PDF Ù„Ù„ØªØ­Ù…ÙŠÙ„...', 'info');
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… pdf-lib Ù„Ø¥Ù†Ø´Ø§Ø¡ PDF Ù…Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
            setTimeout(async () => {
                try {
                    const originalName = editorFile.files[0].name;
                    const extension = originalName.split('.').pop();
                    const baseName = originalName.replace('.' + extension, '');
                    const newFileName = `${baseName}_edited.${extension}`;
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ PDF Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
                    const { PDFDocument, rgb } = PDFLib;
                    const pdfDoc = await PDFDocument.load(currentPdfBytes);
                    const pages = pdfDoc.getPages();
                    const firstPage = pages[0];
                    
                    // Ø¥Ø¶Ø§ÙØ© Ù†Øµ ÙŠÙ…ÙŠØ² Ø£Ù† Ø§Ù„Ù…Ù„Ù ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡
                    firstPage.drawText('ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø­Ø±Ø± PDF - Ù†Ø¸Ø§Ù… ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª', {
                        x: 50,
                        y: firstPage.getHeight() - 50,
                        size: 12,
                        color: rgb(0.95, 0.1, 0.1),
                    });
                    
                    const pdfBytes = await pdfDoc.save();
                    const blob = new Blob([pdfBytes.buffer], {type: 'application/pdf'});
                    saveAs(blob, newFileName);
                    
                    showStatus(editorStatus, 'ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ PDF Ø§Ù„Ù…Ø¹Ø¯Ù„', 'success');
                } catch (err) {
                    console.error(err);
                    showStatus(editorStatus, 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ PDF: ' + err.message, 'error');
                }
            }, 1000);
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªØ±Ø¬Ù…
        function downloadTranslatedFile() {
            if (!translatedDocument) {
                showStatus(translationStatus, 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯ Ù…ØªØ±Ø¬Ù… Ù„Ù„ØªØ­Ù…ÙŠÙ„', 'error');
                return;
            }
            
            showStatus(translationStatus, 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù…Ù„Ù Ù„Ù„ØªØ­Ù…ÙŠÙ„...', 'info');
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ÙˆÙ‡Ù…ÙŠ Ù„Ù„ØªØ­Ù…ÙŠÙ„
            setTimeout(() => {
                const fromLang = currentTranslationDirection === 'en-ar' ? 'en' : 'ar';
                const toLang = currentTranslationDirection === 'en-ar' ? 'ar' : 'en';
                const originalName = translationFile.files[0].name;
                const extension = originalName.split('.').pop();
                const baseName = originalName.replace('.' + extension, '');
                const newFileName = `${baseName}_${fromLang}_to_${toLang}.txt`;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ±Ø¬Ù…
                const blob = new Blob([translatedDocument], {type: 'text/plain;charset=utf-8'});
                saveAs(blob, newFileName);
                
                showStatus(translationStatus, 'ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªØ±Ø¬Ù…', 'success');
            }, 1000);
        }
        
        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
        function showStatus(element, message, type) {
            element.textContent = message;
            element.className = 'status';
            if (type) {
                element.classList.add(type);
            }
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', initApp);
    </script>
</body>
</html>
